<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>classification-prediction-problem</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Classification Prediction Problem_files/libs/clipboard/clipboard.min.js"></script>
<script src="Classification Prediction Problem_files/libs/quarto-html/quarto.js"></script>
<script src="Classification Prediction Problem_files/libs/quarto-html/popper.min.js"></script>
<script src="Classification Prediction Problem_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Classification Prediction Problem_files/libs/quarto-html/anchor.min.js"></script>
<link href="Classification Prediction Problem_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Classification Prediction Problem_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Classification Prediction Problem_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Classification Prediction Problem_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Classification Prediction Problem_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> sm</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.stats.outliers_influence <span class="im">import</span> variance_inflation_factor</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.tools.tools <span class="im">import</span> add_constant</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge, RidgeCV, Lasso, LassoCV</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_curve, auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> pd.read_csv(<span class="st">'train_classification.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> pd.read_csv(<span class="st">'test_classification.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only getting observations with out_prncp_inv not equal to 0</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>train_1 <span class="op">=</span> train.loc[train.out_prncp_inv <span class="op">!=</span> <span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>train_1.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>id</th>
      <th>hi_int_prncp_pd</th>
      <th>acc_now_delinq</th>
      <th>acc_open_past_24mths</th>
      <th>addr_state</th>
      <th>annual_inc</th>
      <th>application_type</th>
      <th>avg_cur_bal</th>
      <th>bc_util</th>
      <th>delinq_2yrs</th>
      <th>...</th>
      <th>out_prncp_inv</th>
      <th>pub_rec</th>
      <th>pub_rec_bankruptcies</th>
      <th>purpose</th>
      <th>sub_grade</th>
      <th>term</th>
      <th>tot_coll_amt</th>
      <th>tot_cur_bal</th>
      <th>total_rec_late_fee</th>
      <th>verification_status</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3821</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>IL</td>
      <td>80000.0</td>
      <td>Individual</td>
      <td>15316</td>
      <td>57.7</td>
      <td>1</td>
      <td>...</td>
      <td>9099.27</td>
      <td>0</td>
      <td>0</td>
      <td>debt_consolidation</td>
      <td>C1</td>
      <td>60 months</td>
      <td>168</td>
      <td>183792</td>
      <td>0.0</td>
      <td>Not Verified</td>
    </tr>
    <tr>
      <th>7</th>
      <td>3826</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>MA</td>
      <td>68000.0</td>
      <td>Individual</td>
      <td>17072</td>
      <td>41.2</td>
      <td>1</td>
      <td>...</td>
      <td>2824.63</td>
      <td>0</td>
      <td>0</td>
      <td>home_improvement</td>
      <td>B5</td>
      <td>36 months</td>
      <td>0</td>
      <td>204865</td>
      <td>30.0</td>
      <td>Not Verified</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3827</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>MI</td>
      <td>10000.0</td>
      <td>Joint App</td>
      <td>4872</td>
      <td>0.0</td>
      <td>0</td>
      <td>...</td>
      <td>17978.39</td>
      <td>0</td>
      <td>0</td>
      <td>house</td>
      <td>B5</td>
      <td>60 months</td>
      <td>0</td>
      <td>29232</td>
      <td>0.0</td>
      <td>Not Verified</td>
    </tr>
    <tr>
      <th>9</th>
      <td>3828</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>RI</td>
      <td>22000.0</td>
      <td>Individual</td>
      <td>1432</td>
      <td>73.4</td>
      <td>0</td>
      <td>...</td>
      <td>10022.34</td>
      <td>0</td>
      <td>0</td>
      <td>debt_consolidation</td>
      <td>C4</td>
      <td>36 months</td>
      <td>0</td>
      <td>11455</td>
      <td>0.0</td>
      <td>Source Verified</td>
    </tr>
    <tr>
      <th>10</th>
      <td>3829</td>
      <td>1</td>
      <td>0</td>
      <td>7</td>
      <td>NC</td>
      <td>85000.0</td>
      <td>Individual</td>
      <td>1348</td>
      <td>85.2</td>
      <td>0</td>
      <td>...</td>
      <td>9807.57</td>
      <td>0</td>
      <td>0</td>
      <td>debt_consolidation</td>
      <td>D3</td>
      <td>60 months</td>
      <td>0</td>
      <td>31002</td>
      <td>0.0</td>
      <td>Source Verified</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 36 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(y <span class="op">=</span> <span class="st">'hi_int_prncp_pd'</span>, x <span class="op">=</span> <span class="st">'application_type'</span>, data <span class="op">=</span> train_1)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Classification%20Prediction%20Problem_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(y <span class="op">=</span> <span class="st">'hi_int_prncp_pd'</span>, x <span class="op">=</span> <span class="st">'term'</span>, data <span class="op">=</span> train_1)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Classification%20Prediction%20Problem_files/figure-html/cell-7-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>These two categorical variables seems to have distinguished hi_int_prncp_pd, so I choose to make dummy variables out of them</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>train_dummy <span class="op">=</span> pd.get_dummies(train_1[[<span class="st">'application_type'</span>, <span class="st">'term'</span>]])</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>train_dummy[<span class="st">'id'</span>] <span class="op">=</span> train_1[<span class="st">'id'</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>train_1 <span class="op">=</span> train_1.merge(train_dummy, on <span class="op">=</span> <span class="st">'id'</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>train_1.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>id</th>
      <th>hi_int_prncp_pd</th>
      <th>acc_now_delinq</th>
      <th>acc_open_past_24mths</th>
      <th>addr_state</th>
      <th>annual_inc</th>
      <th>application_type</th>
      <th>avg_cur_bal</th>
      <th>bc_util</th>
      <th>delinq_2yrs</th>
      <th>...</th>
      <th>sub_grade</th>
      <th>term</th>
      <th>tot_coll_amt</th>
      <th>tot_cur_bal</th>
      <th>total_rec_late_fee</th>
      <th>verification_status</th>
      <th>application_type_Individual</th>
      <th>application_type_Joint App</th>
      <th>term_36 months</th>
      <th>term_60 months</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3821</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>IL</td>
      <td>80000.0</td>
      <td>Individual</td>
      <td>15316</td>
      <td>57.7</td>
      <td>1</td>
      <td>...</td>
      <td>C1</td>
      <td>60 months</td>
      <td>168</td>
      <td>183792</td>
      <td>0.0</td>
      <td>Not Verified</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3826</td>
      <td>1</td>
      <td>0</td>
      <td>5</td>
      <td>MA</td>
      <td>68000.0</td>
      <td>Individual</td>
      <td>17072</td>
      <td>41.2</td>
      <td>1</td>
      <td>...</td>
      <td>B5</td>
      <td>36 months</td>
      <td>0</td>
      <td>204865</td>
      <td>30.0</td>
      <td>Not Verified</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3827</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>MI</td>
      <td>10000.0</td>
      <td>Joint App</td>
      <td>4872</td>
      <td>0.0</td>
      <td>0</td>
      <td>...</td>
      <td>B5</td>
      <td>60 months</td>
      <td>0</td>
      <td>29232</td>
      <td>0.0</td>
      <td>Not Verified</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3828</td>
      <td>1</td>
      <td>0</td>
      <td>4</td>
      <td>RI</td>
      <td>22000.0</td>
      <td>Individual</td>
      <td>1432</td>
      <td>73.4</td>
      <td>0</td>
      <td>...</td>
      <td>C4</td>
      <td>36 months</td>
      <td>0</td>
      <td>11455</td>
      <td>0.0</td>
      <td>Source Verified</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3829</td>
      <td>1</td>
      <td>0</td>
      <td>7</td>
      <td>NC</td>
      <td>85000.0</td>
      <td>Individual</td>
      <td>1348</td>
      <td>85.2</td>
      <td>0</td>
      <td>...</td>
      <td>D3</td>
      <td>60 months</td>
      <td>0</td>
      <td>31002</td>
      <td>0.0</td>
      <td>Source Verified</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 40 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>test_dummy <span class="op">=</span> pd.get_dummies(test[[<span class="st">'application_type'</span>, <span class="st">'term'</span>]])</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>test_dummy[<span class="st">'id'</span>] <span class="op">=</span> test[<span class="st">'id'</span>]</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> test.merge(test_dummy, on <span class="op">=</span> <span class="st">'id'</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>test.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>id</th>
      <th>acc_now_delinq</th>
      <th>acc_open_past_24mths</th>
      <th>addr_state</th>
      <th>annual_inc</th>
      <th>application_type</th>
      <th>avg_cur_bal</th>
      <th>bc_util</th>
      <th>delinq_2yrs</th>
      <th>delinq_amnt</th>
      <th>...</th>
      <th>sub_grade</th>
      <th>term</th>
      <th>tot_coll_amt</th>
      <th>tot_cur_bal</th>
      <th>total_rec_late_fee</th>
      <th>verification_status</th>
      <th>application_type_Individual</th>
      <th>application_type_Joint App</th>
      <th>term_36 months</th>
      <th>term_60 months</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>NV</td>
      <td>59500.0</td>
      <td>Individual</td>
      <td>2652</td>
      <td>37.0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>A2</td>
      <td>36 months</td>
      <td>0</td>
      <td>26517</td>
      <td>0.00</td>
      <td>Verified</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>CA</td>
      <td>140000.0</td>
      <td>Individual</td>
      <td>14868</td>
      <td>21.4</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>A1</td>
      <td>36 months</td>
      <td>5027</td>
      <td>74341</td>
      <td>0.00</td>
      <td>Not Verified</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0</td>
      <td>6</td>
      <td>FL</td>
      <td>65000.0</td>
      <td>Individual</td>
      <td>14826</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>B5</td>
      <td>60 months</td>
      <td>100</td>
      <td>177915</td>
      <td>0.00</td>
      <td>Source Verified</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>CA</td>
      <td>52300.0</td>
      <td>Individual</td>
      <td>12696</td>
      <td>90.6</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>B3</td>
      <td>36 months</td>
      <td>0</td>
      <td>152357</td>
      <td>51.62</td>
      <td>Source Verified</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>5</td>
      <td>IL</td>
      <td>89000.0</td>
      <td>Individual</td>
      <td>21720</td>
      <td>79.3</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>C4</td>
      <td>60 months</td>
      <td>0</td>
      <td>325807</td>
      <td>0.00</td>
      <td>Verified</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 39 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>train_1 <span class="op">=</span> train_1.rename(columns<span class="op">=</span>{<span class="st">"application_type_Joint App"</span>: <span class="st">"Joint_app"</span>, <span class="st">"application_type_Individual"</span> : <span class="st">"Individual_app"</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"term_36 months"</span>: <span class="st">"term_36_months"</span>, <span class="st">"term_60 months"</span>:<span class="st">"term_60_months"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> test.rename(columns<span class="op">=</span>{<span class="st">"application_type_Joint App"</span>: <span class="st">"Joint_app"</span>, <span class="st">"application_type_Individual"</span> : <span class="st">"Individual_app"</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"term_36 months"</span>: <span class="st">"term_36_months"</span>, <span class="st">"term_60 months"</span>:<span class="st">"term_60_months"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>model11 <span class="op">=</span> sm.ols(<span class="st">'hi_int_prncp_pd ~ acc_now_delinq + acc_open_past_24mths + annual_inc +</span><span class="ch">\</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="st">avg_cur_bal + bc_util + delinq_2yrs + delinq_amnt + dti +</span><span class="ch">\</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="st">int_rate + loan_amnt + mort_acc + num_sats + </span><span class="ch">\</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="st">num_tl_120dpd_2m + num_tl_90g_dpd_24m + num_tl_30dpd + out_prncp_inv + pub_rec + pub_rec_bankruptcies +</span><span class="ch">\</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="st">tot_coll_amt + tot_cur_bal + total_rec_late_fee'</span>, data <span class="op">=</span> train_1).fit()</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>model11.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

<table class="simpletable">
<caption>OLS Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>     <td>hi_int_prncp_pd</td> <th>  R-squared:         </th> <td>   0.253</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.247</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   40.96</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 20 Mar 2023</td> <th>  Prob (F-statistic):</th> <td>3.86e-137</td>
</tr>
<tr>
  <th>Time:</th>                 <td>01:34:55</td>     <th>  Log-Likelihood:    </th> <td> -1400.1</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>  2444</td>      <th>  AIC:               </th> <td>   2842.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>  2423</td>      <th>  BIC:               </th> <td>   2964.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>    20</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
            <td></td>              <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P&gt;|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>            <td>   -0.1896</td> <td>    0.039</td> <td>   -4.881</td> <td> 0.000</td> <td>   -0.266</td> <td>   -0.113</td>
</tr>
<tr>
  <th>acc_now_delinq</th>       <td>   -0.1869</td> <td>    0.434</td> <td>   -0.431</td> <td> 0.667</td> <td>   -1.037</td> <td>    0.663</td>
</tr>
<tr>
  <th>acc_open_past_24mths</th> <td>   -0.0055</td> <td>    0.003</td> <td>   -1.579</td> <td> 0.114</td> <td>   -0.012</td> <td>    0.001</td>
</tr>
<tr>
  <th>annual_inc</th>           <td>-2.885e-08</td> <td> 4.87e-08</td> <td>   -0.593</td> <td> 0.553</td> <td>-1.24e-07</td> <td> 6.66e-08</td>
</tr>
<tr>
  <th>avg_cur_bal</th>          <td> 6.121e-08</td> <td> 1.14e-06</td> <td>    0.054</td> <td> 0.957</td> <td>-2.17e-06</td> <td> 2.29e-06</td>
</tr>
<tr>
  <th>bc_util</th>              <td>   -0.0002</td> <td>    0.000</td> <td>   -0.457</td> <td> 0.648</td> <td>   -0.001</td> <td>    0.001</td>
</tr>
<tr>
  <th>delinq_2yrs</th>          <td>   -0.0108</td> <td>    0.013</td> <td>   -0.826</td> <td> 0.409</td> <td>   -0.036</td> <td>    0.015</td>
</tr>
<tr>
  <th>delinq_amnt</th>          <td>-6.845e-05</td> <td> 4.18e-05</td> <td>   -1.637</td> <td> 0.102</td> <td>   -0.000</td> <td> 1.35e-05</td>
</tr>
<tr>
  <th>dti</th>                  <td>   -0.0018</td> <td>    0.001</td> <td>   -1.742</td> <td> 0.082</td> <td>   -0.004</td> <td>    0.000</td>
</tr>
<tr>
  <th>int_rate</th>             <td>    0.0458</td> <td>    0.002</td> <td>   22.287</td> <td> 0.000</td> <td>    0.042</td> <td>    0.050</td>
</tr>
<tr>
  <th>loan_amnt</th>            <td>-4.636e-06</td> <td> 1.68e-06</td> <td>   -2.764</td> <td> 0.006</td> <td>-7.92e-06</td> <td>-1.35e-06</td>
</tr>
<tr>
  <th>mort_acc</th>             <td>    0.0099</td> <td>    0.006</td> <td>    1.748</td> <td> 0.081</td> <td>   -0.001</td> <td>    0.021</td>
</tr>
<tr>
  <th>num_sats</th>             <td>    0.0028</td> <td>    0.002</td> <td>    1.247</td> <td> 0.213</td> <td>   -0.002</td> <td>    0.007</td>
</tr>
<tr>
  <th>num_tl_120dpd_2m</th>     <td>-5.727e-16</td> <td> 8.69e-16</td> <td>   -0.659</td> <td> 0.510</td> <td>-2.28e-15</td> <td> 1.13e-15</td>
</tr>
<tr>
  <th>num_tl_90g_dpd_24m</th>   <td>   -0.0025</td> <td>    0.025</td> <td>   -0.099</td> <td> 0.921</td> <td>   -0.052</td> <td>    0.047</td>
</tr>
<tr>
  <th>num_tl_30dpd</th>         <td>   -0.0102</td> <td>    0.474</td> <td>   -0.022</td> <td> 0.983</td> <td>   -0.940</td> <td>    0.920</td>
</tr>
<tr>
  <th>out_prncp_inv</th>        <td> 1.677e-05</td> <td> 1.92e-06</td> <td>    8.744</td> <td> 0.000</td> <td>  1.3e-05</td> <td> 2.05e-05</td>
</tr>
<tr>
  <th>pub_rec</th>              <td>    0.0341</td> <td>    0.027</td> <td>    1.275</td> <td> 0.203</td> <td>   -0.018</td> <td>    0.087</td>
</tr>
<tr>
  <th>pub_rec_bankruptcies</th> <td>   -0.0715</td> <td>    0.040</td> <td>   -1.771</td> <td> 0.077</td> <td>   -0.151</td> <td>    0.008</td>
</tr>
<tr>
  <th>tot_coll_amt</th>         <td>-1.413e-05</td> <td> 6.47e-06</td> <td>   -2.183</td> <td> 0.029</td> <td>-2.68e-05</td> <td>-1.44e-06</td>
</tr>
<tr>
  <th>tot_cur_bal</th>          <td> -5.61e-08</td> <td> 1.24e-07</td> <td>   -0.453</td> <td> 0.651</td> <td>-2.99e-07</td> <td> 1.87e-07</td>
</tr>
<tr>
  <th>total_rec_late_fee</th>   <td>    0.0002</td> <td>    0.001</td> <td>    0.418</td> <td> 0.676</td> <td>   -0.001</td> <td>    0.001</td>
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
  <th>Omnibus:</th>       <td>239.735</td> <th>  Durbin-Watson:     </th> <td>   1.969</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td>  76.946</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.132</td>  <th>  Prob(JB):          </th> <td>1.96e-17</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.172</td>  <th>  Cond. No.          </th> <td>7.15e+22</td>
</tr>
</tbody></table><br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br>[2] The smallest eigenvalue is 3.38e-32. This might indicate that there are<br>strong multicollinearity problems or that the design matrix is singular.
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a set of predictors from which we need to find the best subset of predictors</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> train_1[[<span class="st">'acc_now_delinq'</span>, <span class="st">'acc_open_past_24mths'</span>, <span class="st">'annual_inc'</span>, <span class="st">'avg_cur_bal'</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'bc_util'</span>, <span class="st">'delinq_2yrs'</span>, <span class="st">'delinq_amnt'</span>, <span class="st">'dti'</span>, <span class="st">'int_rate'</span>, <span class="st">'loan_amnt'</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>       <span class="st">'mort_acc'</span>, <span class="st">'num_sats'</span>, <span class="st">'num_tl_120dpd_2m'</span>, <span class="st">'num_tl_90g_dpd_24m'</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>       <span class="st">'num_tl_30dpd'</span>, <span class="st">'out_prncp_inv'</span>, <span class="st">'pub_rec'</span>, <span class="st">'pub_rec_bankruptcies'</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>       <span class="st">'tot_coll_amt'</span>, <span class="st">'tot_cur_bal'</span>, <span class="st">'total_rec_late_fee'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Function to develop a model based on all predictors in predictor_subset</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> processSubset(predictor_subset):</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fit model on feature_set and calculate R-squared</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> sm.ols(<span class="st">'hi_int_prncp_pd ~'</span> <span class="op">+</span> <span class="st">'+'</span>.join(predictor_subset),data <span class="op">=</span> train_1).fit()</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    Rsquared <span class="op">=</span> model.rsquared</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">"model"</span>:model, <span class="st">"Rsquared"</span>:Rsquared}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Function to find the best predictor out of p-k predictors and add it to the model containing the k predictors</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward(predictors):</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pull out predictors we still need to process</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    remaining_predictors <span class="op">=</span> [p <span class="cf">for</span> p <span class="kw">in</span> X.columns <span class="cf">if</span> p <span class="kw">not</span> <span class="kw">in</span> predictors]</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    tic <span class="op">=</span> time.time()</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> p <span class="kw">in</span> remaining_predictors:</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>        results.append(processSubset(predictors<span class="op">+</span>[p]))</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Wrap everything up in a nice dataframe</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    models <span class="op">=</span> pd.DataFrame(results)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Choose the model with the highest RSS</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    best_model <span class="op">=</span> models.loc[models[<span class="st">'Rsquared'</span>].argmax()]</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    toc <span class="op">=</span> time.time()</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Processed "</span>, models.shape[<span class="dv">0</span>], <span class="st">"models on"</span>, <span class="bu">len</span>(predictors)<span class="op">+</span><span class="dv">1</span>, <span class="st">"predictors in"</span>, (toc<span class="op">-</span>tic), <span class="st">"seconds."</span>)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the best model, along with some other useful information about the model</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward_selection():</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    models_best <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">"Rsquared"</span>, <span class="st">"model"</span>])</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    tic <span class="op">=</span> time.time()</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    predictors <span class="op">=</span> []</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="bu">len</span>(X.columns)<span class="op">+</span><span class="dv">1</span>):    </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        models_best.loc[i] <span class="op">=</span> forward(predictors)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        predictors <span class="op">=</span> <span class="bu">list</span>(models_best.loc[i][<span class="st">"model"</span>].params.index[<span class="dv">1</span>:])</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    toc <span class="op">=</span> time.time()</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Total elapsed time:"</span>, (toc<span class="op">-</span>tic), <span class="st">"seconds."</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> models_best</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>models_best <span class="op">=</span> forward_selection()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Processed  21 models on 1 predictors in 0.23395609855651855 seconds.
Processed  20 models on 2 predictors in 0.24501395225524902 seconds.
Processed  19 models on 3 predictors in 0.3604621887207031 seconds.
Processed  18 models on 4 predictors in 0.3467268943786621 seconds.
Processed  17 models on 5 predictors in 0.3824310302734375 seconds.
Processed  16 models on 6 predictors in 0.46936583518981934 seconds.
Processed  15 models on 7 predictors in 0.47344112396240234 seconds.
Processed  14 models on 8 predictors in 0.45027780532836914 seconds.
Processed  13 models on 9 predictors in 0.41890788078308105 seconds.
Processed  12 models on 10 predictors in 0.43041491508483887 seconds.
Processed  11 models on 11 predictors in 0.44140172004699707 seconds.
Processed  10 models on 12 predictors in 0.3979830741882324 seconds.
Processed  9 models on 13 predictors in 0.4202439785003662 seconds.
Processed  8 models on 14 predictors in 0.3883211612701416 seconds.
Processed  7 models on 15 predictors in 0.3566908836364746 seconds.
Processed  6 models on 16 predictors in 0.29801082611083984 seconds.
Processed  5 models on 17 predictors in 0.26439976692199707 seconds.
Processed  4 models on 18 predictors in 0.23300504684448242 seconds.
Processed  3 models on 19 predictors in 0.15892601013183594 seconds.
Processed  2 models on 20 predictors in 0.11254358291625977 seconds.
Processed  1 models on 21 predictors in 0.05923891067504883 seconds.
Total elapsed time: 7.051849365234375 seconds.</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> best_sub_plots():</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">10</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    plt.rcParams.update({<span class="st">'font.size'</span>: <span class="dv">18</span>, <span class="st">'lines.markersize'</span>: <span class="dv">10</span>})</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set up a 2x2 grid so we can look at 4 plots at once</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We will now plot a red dot to indicate the model with the largest adjusted R^2 statistic.</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The argmax() function can be used to identify the location of the maximum point of a vector</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    plt.plot(models_best[<span class="st">"Rsquared"</span>])</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'# Predictors'</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Rsquared'</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We will now plot a red dot to indicate the model with the largest adjusted R^2 statistic.</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The argmax() function can be used to identify the location of the maximum point of a vector</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    rsquared_adj <span class="op">=</span> models_best.<span class="bu">apply</span>(<span class="kw">lambda</span> row: row[<span class="dv">1</span>].rsquared_adj, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    plt.plot(rsquared_adj)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    plt.plot(<span class="dv">1</span><span class="op">+</span>rsquared_adj.argmax(), rsquared_adj.<span class="bu">max</span>(), <span class="st">"or"</span>)</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'# Predictors'</span>)</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'adjusted rsquared'</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># We'll do the same for AIC and BIC, this time looking for the models with the SMALLEST statistic</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    aic <span class="op">=</span> models_best.<span class="bu">apply</span>(<span class="kw">lambda</span> row: row[<span class="dv">1</span>].aic, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    plt.plot(aic)</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    plt.plot(<span class="dv">1</span><span class="op">+</span>aic.argmin(), aic.<span class="bu">min</span>(), <span class="st">"or"</span>)</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'# Predictors'</span>)</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'AIC'</span>)</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    bic <span class="op">=</span> models_best.<span class="bu">apply</span>(<span class="kw">lambda</span> row: row[<span class="dv">1</span>].bic, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    plt.plot(bic)</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>    plt.plot(<span class="dv">1</span><span class="op">+</span>bic.argmin(), bic.<span class="bu">min</span>(), <span class="st">"or"</span>)</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'# Predictors'</span>)</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'BIC'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>best_sub_plots()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Classification%20Prediction%20Problem_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>best_fwd_reg_model <span class="op">=</span> models_best[<span class="st">'model'</span>][<span class="dv">7</span>]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>best_fwd_reg_model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">

<table class="simpletable">
<caption>OLS Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>     <td>hi_int_prncp_pd</td> <th>  R-squared:         </th> <td>   0.250</td> 
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.247</td> 
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   115.7</td> 
</tr>
<tr>
  <th>Date:</th>             <td>Mon, 20 Mar 2023</td> <th>  Prob (F-statistic):</th> <td>6.44e-147</td>
</tr>
<tr>
  <th>Time:</th>                 <td>01:35:21</td>     <th>  Log-Likelihood:    </th> <td> -1405.2</td> 
</tr>
<tr>
  <th>No. Observations:</th>      <td>  2444</td>      <th>  AIC:               </th> <td>   2826.</td> 
</tr>
<tr>
  <th>Df Residuals:</th>          <td>  2436</td>      <th>  BIC:               </th> <td>   2873.</td> 
</tr>
<tr>
  <th>Df Model:</th>              <td>     7</td>      <th>                     </th>     <td> </td>    
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>    
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
        <td></td>           <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P&gt;|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>     <td>   -0.1961</td> <td>    0.032</td> <td>   -6.187</td> <td> 0.000</td> <td>   -0.258</td> <td>   -0.134</td>
</tr>
<tr>
  <th>int_rate</th>      <td>    0.0446</td> <td>    0.002</td> <td>   23.904</td> <td> 0.000</td> <td>    0.041</td> <td>    0.048</td>
</tr>
<tr>
  <th>out_prncp_inv</th> <td> 1.671e-05</td> <td> 1.88e-06</td> <td>    8.884</td> <td> 0.000</td> <td>  1.3e-05</td> <td> 2.04e-05</td>
</tr>
<tr>
  <th>loan_amnt</th>     <td>-4.421e-06</td> <td> 1.63e-06</td> <td>   -2.713</td> <td> 0.007</td> <td>-7.62e-06</td> <td>-1.23e-06</td>
</tr>
<tr>
  <th>tot_coll_amt</th>  <td>-1.295e-05</td> <td> 6.44e-06</td> <td>   -2.009</td> <td> 0.045</td> <td>-2.56e-05</td> <td>-3.13e-07</td>
</tr>
<tr>
  <th>delinq_amnt</th>   <td>-7.107e-05</td> <td> 4.17e-05</td> <td>   -1.706</td> <td> 0.088</td> <td>   -0.000</td> <td> 1.06e-05</td>
</tr>
<tr>
  <th>dti</th>           <td>   -0.0014</td> <td>    0.001</td> <td>   -1.488</td> <td> 0.137</td> <td>   -0.003</td> <td>    0.000</td>
</tr>
<tr>
  <th>mort_acc</th>      <td>    0.0069</td> <td>    0.005</td> <td>    1.453</td> <td> 0.146</td> <td>   -0.002</td> <td>    0.016</td>
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
  <th>Omnibus:</th>       <td>270.060</td> <th>  Durbin-Watson:     </th> <td>   1.968</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.000</td>  <th>  Jarque-Bera (JB):  </th> <td>  82.164</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.141</td>  <th>  Prob(JB):          </th> <td>1.44e-18</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.147</td>  <th>  Cond. No.          </th> <td>8.28e+04</td>
</tr>
</tbody></table><br><br>Notes:<br>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.<br>[2] The condition number is large, 8.28e+04. This might indicate that there are<br>strong multicollinearity or other numerical problems.
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>predictor_set <span class="op">=</span> [<span class="st">'out_prncp_inv'</span>,<span class="st">'loan_amnt'</span>,<span class="st">'mort_acc'</span>,<span class="st">'int_rate'</span>,<span class="st">'total_rec_late_fee'</span>,<span class="st">'bc_util'</span>]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> np.arange(<span class="dv">0</span>,<span class="dv">6</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>polynomial_transformations <span class="op">=</span> pd.DataFrame(product(values, repeat<span class="op">=</span><span class="dv">6</span>), columns<span class="op">=</span>predictor_set).loc[<span class="dv">1</span>:,]</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>polynomial_transformations.loc[:,<span class="st">'sum_degree'</span>] <span class="op">=</span> (polynomial_transformations).astype(<span class="bu">int</span>).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>polynomial_transformations.loc[:,<span class="st">'count_zeros'</span>] <span class="op">=</span> (polynomial_transformations <span class="op">==</span> <span class="dv">0</span>).astype(<span class="bu">int</span>).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>polynomial_transformations.sort_values(by <span class="op">=</span> [<span class="st">'count_zeros'</span>, <span class="st">'sum_degree'</span>], ascending<span class="op">=</span>[<span class="va">False</span>, <span class="va">True</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>polynomial_transformations.drop(columns <span class="op">=</span> [<span class="st">'count_zeros'</span>], inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>polynomial_transformations.reset_index(inplace <span class="op">=</span> <span class="va">True</span>, drop <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Setting the seed as we are shuffling the data before splitting it into K-folds</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Shuffling the training set before creating K folds</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> train_1.sample(frac<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">7</span> <span class="co">#5-fold cross validation</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>fold_size <span class="op">=</span> np.<span class="bu">round</span>(train_1.shape[<span class="dv">0</span>]<span class="op">/</span>k)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> KFoldCV(selected_interactions, interaction_being_tested):</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    cv_vals <span class="op">=</span> []</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> ii <span class="kw">in</span> <span class="bu">range</span>(k):</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        val_indices <span class="op">=</span> np.arange(ii<span class="op">*</span>(fold_size),(ii<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>fold_size)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        val_set <span class="op">=</span> train_1.iloc[val_indices, :]</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        train_set <span class="op">=</span> train_1.drop(train_1.iloc[val_indices, :].index.tolist())</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> sm.logit(<span class="st">'hi_int_prncp_pd~out_prncp_inv+loan_amnt+mort_acc+int_rate+Joint_app+</span><span class="ch">\</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="st">        Individual_app+term_36_months+term_60_months+total_rec_late_fee+bc_util'</span><span class="op">+</span>selected_interactions<span class="op">+\</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                       interaction_being_tested, data <span class="op">=</span> train_set).fit()</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>        pred_price <span class="op">=</span> model.predict(val_set)     </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>        cv_vals.append(np.sqrt(((val_set[<span class="st">'hi_int_prncp_pd'</span>]<span class="op">-</span>pred_price)<span class="op">**</span><span class="dv">2</span>).mean()))</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (np.mean(cv_vals))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 5-fold cross validation RMSE of the initial model with the 4 predictors of degree one</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>cv_previous_model <span class="op">=</span> KFoldCV(selected_interactions <span class="op">=</span> <span class="st">''</span>, interaction_being_tested <span class="op">=</span> <span class="st">''</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>interaction_being_tested <span class="op">=</span> <span class="st">'+'</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>selected_interactions <span class="op">=</span> <span class="st">''</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Considering interactions of degree 'd' = 2 to 12</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> d <span class="kw">in</span> np.arange(<span class="dv">2</span>,<span class="dv">13</span>):</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Selecting interaction terms of degree = 'd'</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    degree_set <span class="op">=</span> polynomial_transformations.loc[polynomial_transformations.sum_degree<span class="op">==</span>d, :]</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initializing objects to store the interactions of degree 'd' that reduce the</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 5-fold cross validation RMSEs as compared to the previous model</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    interactions_that_reduce_KfoldCV <span class="op">=</span> []<span class="op">;</span> cv_degree <span class="op">=</span> []<span class="op">;</span> </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Creating another DataFrame that will consist of the updated set of interactions of degree 'd' to be considered</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># as interactions that do not reduce the 5-fold cross validation RMSE will be discarded</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    degree_set_updated <span class="op">=</span> pd.DataFrame(columns <span class="op">=</span> degree_set.columns)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Continue adding interactions of degree 'd' in the model until no interactions reduce </span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the 5-fold cross-validation RMSE</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>        <span class="co">#Iterating over all possible interactions of degree 'd'</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> index, row <span class="kw">in</span> degree_set.iterrows():</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Creating the formula expression for the interaction term to be tested</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> predictor <span class="kw">in</span> predictor_set:</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>                interaction_being_tested <span class="op">=</span> interaction_being_tested <span class="op">+</span> (<span class="st">'I('</span><span class="op">+</span>predictor <span class="op">+</span><span class="st">'**'</span> <span class="op">+\</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>                                         <span class="bu">str</span>(row[predictor]) <span class="op">+</span> <span class="st">')*'</span> <span class="cf">if</span> row[predictor]<span class="op">&gt;</span><span class="dv">1</span> <span class="cf">else</span><span class="op">\</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>                                               predictor <span class="op">+</span> <span class="st">'*'</span> <span class="cf">if</span> row[predictor]<span class="op">==</span><span class="dv">1</span> <span class="cf">else</span> <span class="st">''</span>)</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>            interaction_being_tested <span class="op">=</span> interaction_being_tested[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Call the function 'KFoldCV' to find out the 5-fold cross validation error on adding the </span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>            <span class="co"># interaction term being tested to the model</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>            cv <span class="op">=</span> KFoldCV(selected_interactions, interaction_being_tested)</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If the interaction term being tested reduces the 5-fold cross validation RMSE as compared to the</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>            <span class="co"># previous model, then consider adding it to the model</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> cv<span class="op">&lt;</span>cv_previous_model:</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>                interactions_that_reduce_KfoldCV.append(interaction_being_tested)</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>                cv_degree.append(cv)</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>                degree_set_updated <span class="op">=</span> pd.concat([degree_set_updated, row.to_frame().T])</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>            interaction_being_tested <span class="op">=</span> <span class="st">'+'</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>        cv_data <span class="op">=</span> pd.DataFrame({<span class="st">'interaction'</span>:interactions_that_reduce_KfoldCV, <span class="st">'cv'</span>:cv_degree})</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Sort the interaction terms that reduce the 5-fold cross valdiation RMSE based on their respective</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 5-fold cross validation RMSE</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>        cv_data.sort_values(by <span class="op">=</span> <span class="st">'cv'</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Break the loop if no interaction of degree 'd' reduces the 5-fold cross validation RMSE as</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># compared to the previous model</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cv_data.shape[<span class="dv">0</span>]<span class="op">==</span><span class="dv">0</span>:</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Select the interaction that corresponds to the least 5-fold cross validation RMSE</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>        selected_interactions <span class="op">=</span> selected_interactions <span class="op">+</span> cv_data.iloc[<span class="dv">0</span>,<span class="dv">0</span>]</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>        cv_previous_model <span class="op">=</span> cv_data.iloc[<span class="dv">0</span>,<span class="dv">1</span>]</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>        cv_degree <span class="op">=</span> []<span class="op">;</span> interactions_that_reduce_KfoldCV <span class="op">=</span> []</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>        degree_set <span class="op">=</span> degree_set_updated.copy()</span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>        degree_set_updated <span class="op">=</span> pd.DataFrame(columns <span class="op">=</span> degree_set.columns)</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print the progress after each model update, i.e., after an interaction term is selected</span></span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Degree of interactions being considered:"</span>,d, <span class="st">", 5-fold CV RMSE:"</span>, cv_previous_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.495103
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.495714
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.500484
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.509036
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.507685
         Iterations 6
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.506349
         Iterations: 35</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/linhnganguyen/opt/anaconda3/lib/python3.9/site-packages/statsmodels/base/model.py:604: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.504041
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.494596
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.495593
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.499398
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.508127
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.507453
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.505866
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.503327
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.494943
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.495582
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.500459
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.509034
         Iterations 24
Optimization terminated successfully.
         Current function value: 0.507556
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.506348
         Iterations 8
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.503999
         Iterations: 35</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/linhnganguyen/opt/anaconda3/lib/python3.9/site-packages/statsmodels/base/model.py:604: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.486498
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.481201
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.491062
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.499103
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.495001
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.498139
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.491751
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.494958
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.495693
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.500483
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.509036
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.507684
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.506345
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.504027
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.494701
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.495486
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.500143
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.508857
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.507641
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.505802
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.503672
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.492658
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493368
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.498154
         Iterations 20
Optimization terminated successfully.
         Current function value: 0.506513
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.506154
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.503314
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.501490
         Iterations 7
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.495024
         Iterations: 35</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/linhnganguyen/opt/anaconda3/lib/python3.9/site-packages/statsmodels/base/model.py:604: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.495631
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.499994
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.508783
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.507612
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.506009
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.503814
         Iterations 13
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.495009
         Iterations: 35
Optimization terminated successfully.
         Current function value: 0.495538
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.500458
         Iterations 6</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/linhnganguyen/opt/anaconda3/lib/python3.9/site-packages/statsmodels/base/model.py:604: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.508916
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.507402
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.506293
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.503993
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.494853
         Iterations 28
Optimization terminated successfully.
         Current function value: 0.494988
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.500264
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.508575
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.507449
         Iterations 28
Optimization terminated successfully.
         Current function value: 0.506117
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.503631
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.495063
         Iterations 9
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.495442
         Iterations: 35</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/linhnganguyen/opt/anaconda3/lib/python3.9/site-packages/statsmodels/base/model.py:604: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.500472
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.509009
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.507685
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.506339
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.504039
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.494553
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.495630
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.500094
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.508755
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.507326
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.506055
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.503776
         Iterations 8
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.494493
         Iterations: 35
Optimization terminated successfully.
         Current function value: 0.495710
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.500277
         Iterations 8</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/linhnganguyen/opt/anaconda3/lib/python3.9/site-packages/statsmodels/base/model.py:604: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.508232
         Iterations: 35
Optimization terminated successfully.
         Current function value: 0.507370
         Iterations 9
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.506090
         Iterations: 35</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/linhnganguyen/opt/anaconda3/lib/python3.9/site-packages/statsmodels/base/model.py:604: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "
/Users/linhnganguyen/opt/anaconda3/lib/python3.9/site-packages/statsmodels/base/model.py:604: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.503665
         Iterations 16
Optimization terminated successfully.
         Current function value: 0.494642
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.494341
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.500008
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.508450
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.507312
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.506117
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.503944
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.493986
         Iterations 19
Optimization terminated successfully.
         Current function value: 0.495658
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.499436
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.508370
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.507010
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.505317
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.503027
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.491879
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.491831
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.497061
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.504654
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.504684
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.502988
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.500133
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.493687
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.494627
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.499503
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.508336
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.507024
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.506064
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.503450
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.494278
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.493908
         Iterations 32
Optimization terminated successfully.
         Current function value: 0.499857
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.508402
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.507253
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.505955
         Iterations 19
Optimization terminated successfully.
         Current function value: 0.503883
         Iterations 23
Optimization terminated successfully.
         Current function value: 0.494797
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.495299
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.500104
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.508676
         Iterations 7
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.507468
         Iterations: 35</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/linhnganguyen/opt/anaconda3/lib/python3.9/site-packages/statsmodels/base/model.py:604: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.506070
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.503646
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.492183
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.492435
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.496728
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.505696
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.504671
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.503635
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.500038
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.494784
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.495498
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.500226
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.508990
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.507618
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.506332
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.503916
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.492465
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.493849
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.498281
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.506716
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.506437
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.503546
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.501808
         Iterations 8
Degree of interactions being considered: 2 , 5-fold CV RMSE: 0.3964342049134616
Optimization terminated successfully.
         Current function value: 0.486498
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.481201
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.491062
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.499103
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.495001
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.498139
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.491751
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486237
         Iterations 19
Optimization terminated successfully.
         Current function value: 0.481011
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.490829
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.498986
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.494988
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.497669
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.491496
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.484289
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.479012
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.488948
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.496717
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.493667
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.495304
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.489473
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.486029
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.481039
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.490673
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.498787
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.494627
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.497822
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.491457
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486138
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.479916
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.490658
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.498587
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.494665
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.497944
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.491661
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.485474
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.481155
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.490051
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.498435
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.494307
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.497182
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.490700
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.484812
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.479983
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.490002
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.498280
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.494164
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.497783
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.491081
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.485745
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.479391
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.490480
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.498523
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.494565
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.497760
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.491575
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.484089
         Iterations 13</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.479390
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.489015
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.496890
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493914
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.495453
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.489725
         Iterations 7
Degree of interactions being considered: 2 , 5-fold CV RMSE: 0.39511968450251717
Optimization terminated successfully.
         Current function value: 0.484289
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.479012
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.488948
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.496717
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.493667
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.495304
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.489473
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.483780
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.478859
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.488539
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.496371
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.493272
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.494950
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.489158
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.483217
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.478948
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487893
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.496017
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.492964
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.494249
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.488395
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.482208
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.477410
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487535
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.495588
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.492542
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.494711
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.488662
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.483853
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.477765
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.488645
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.496414
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.493444
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.495111
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.489416
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.484061
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.479011
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.488880
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.496682
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493666
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.495240
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.489462
         Iterations 13
Degree of interactions being considered: 2 , 5-fold CV RMSE: 0.3948215225921295
Optimization terminated successfully.
         Current function value: 0.481689
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.477290
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487127
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.495251
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.492134
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.494359
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.488343
         Iterations 21
Optimization terminated successfully.
         Current function value: 0.481117
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.477354
         Iterations 16
Optimization terminated successfully.
         Current function value: 0.486458
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.494879
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.491840
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.493643
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.487554
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.482208
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.477410
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487535
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.495588
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.492542
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.494711
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.488662
         Iterations 7
Degree of interactions being considered: 2 , 5-fold CV RMSE: 0.39467526714950896
Optimization terminated successfully.
         Current function value: 0.481689
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.477290
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487127
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.495251
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.492134
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.494359
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.488343
         Iterations 21
Optimization terminated successfully.
         Current function value: 0.480827
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.477241
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.486267
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.494715
         Iterations 6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.491632
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493525
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.487438
         Iterations 15
Degree of interactions being considered: 2 , 5-fold CV RMSE: 0.39459241317418925
Optimization terminated successfully.
         Current function value: 0.480827
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.477241
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.486267
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.494715
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.491632
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493525
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.487438
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.480325
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.477139
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.485364
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.493736
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.491448
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.492999
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486629
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.480577
         Iterations 24
Optimization terminated successfully.
         Current function value: 0.477140
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.486207
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.494659
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.491459
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.493474
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.487278
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.480040
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.476605
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.485539
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493783
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.491403
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.493030
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486935
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.480766
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.477225
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.486265
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.494715
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.491631
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.493525
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.487437
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.480403
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.476604
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.485842
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.493937
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.490793
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.493102
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.486838
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.479744
         Iterations 16
Optimization terminated successfully.
         Current function value: 0.474748
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.485240
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493796
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.489843
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.492046
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.486440
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.480305
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.477068
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.484684
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.493557
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.491373
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.492750
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.486506
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.480527
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.477074
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.485760
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.494538
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.491366
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493268
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.487148
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.480041
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.476769
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.485054
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.493552
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.491281
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.492764
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486214
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.480077
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.476147
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.485468
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.493865
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.490848
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.492402
         Iterations 17
Optimization terminated successfully.
         Current function value: 0.486252
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.480523
         Iterations 7</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.476978
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.485900
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.494474
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.491473
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.493344
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486921
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.480030
         Iterations 17
Optimization terminated successfully.
         Current function value: 0.476152
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.485553
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.493916
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.490791
         Iterations 20
Optimization terminated successfully.
         Current function value: 0.492282
         Iterations 18
Optimization terminated successfully.
         Current function value: 0.486252
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.480322
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.477147
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.485045
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493446
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.491279
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.492824
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486496
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.480536
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.477086
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.486227
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.494694
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.491513
         Iterations 18
Optimization terminated successfully.
         Current function value: 0.493416
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.487324
         Iterations 8
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.480202
         Iterations: 35</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/linhnganguyen/opt/anaconda3/lib/python3.9/site-packages/statsmodels/base/model.py:604: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn("Maximum Likelihood optimization failed to "</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.477101
         Iterations 16
Optimization terminated successfully.
         Current function value: 0.485897
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493669
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.491065
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.493055
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486545
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.480799
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.477168
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.486190
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.494560
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.491588
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493373
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.487339
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.480801
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.477137
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.486176
         Iterations 16
Optimization terminated successfully.
         Current function value: 0.494683
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.491495
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.493455
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.487393
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.480546
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.477179
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.486176
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.493548
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.491572
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493289
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.487096
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.480178
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.476503
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.485162
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493459
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.491352
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.493058
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486680
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.480456
         Iterations 22
Optimization terminated successfully.
         Current function value: 0.477165
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.486229
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.494670
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.491434
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.493504
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.487319
         Iterations 16
Optimization terminated successfully.
         Current function value: 0.477420
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.473942
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.482404
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.490487
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487940
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.490007
         Iterations 23
Optimization terminated successfully.
         Current function value: 0.483243
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.480415
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.476941
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.486055
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.494479
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.491610
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.492886
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.487023
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.480148
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.475732
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.485599
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.493563
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.490834
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.493021
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.486950
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.480469
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.476845
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.485910
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.493971
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.490881
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.493137
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.486950
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.477815
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.474022
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.482972
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.491031
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.488114
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.490353
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.483602
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.480392
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.476699
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.485509
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493321
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.490685
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.492985
         Iterations 10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.486675
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.479817
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.476171
         Iterations 19
Optimization terminated successfully.
         Current function value: 0.484995
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493396
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.491313
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.492979
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.486644
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.480608
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.476452
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.486232
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.494693
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.491516
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.493450
         Iterations 19
Optimization terminated successfully.
         Current function value: 0.487316
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.477540
         Iterations 16
Optimization terminated successfully.
         Current function value: 0.474757
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.482164
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.491391
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.488173
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.490476
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.483288
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.480180
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.476785
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.486039
         Iterations 17
Optimization terminated successfully.
         Current function value: 0.494310
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.491504
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.493118
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.487005
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.479842
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.476835
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.485780
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.493575
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.490952
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.492972
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.486942
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.480034
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.475938
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.485772
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.494346
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.491472
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.493253
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487345
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.480640
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.475944
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.486215
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.494686
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.491598
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493462
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487349
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.477376
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.474346
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.482305
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.491751
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.487950
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.490278
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.483118
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.480509
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.477146
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.486091
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.494404
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.491370
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.493405
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.487315
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.480725
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.476117
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.486016
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.494478
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.490773
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.493166
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486924
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.479810
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.475375
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.484651
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.493589
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.490622
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.491826
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.485544
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.480264
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.476979
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.485353
         Iterations 7</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.493823
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.491182
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.492785
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486828
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.479901
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.476689
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.485406
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.492986
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.490818
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.492718
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.485959
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.479509
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.476031
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.485056
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.492639
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.490152
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.491669
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.485288
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.480440
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.476382
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.485307
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.494222
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.491295
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.493070
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487157
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.475501
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.470933
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.480608
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.488533
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.485619
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.488309
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.481341
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.476622
         Iterations 22
Optimization terminated successfully.
         Current function value: 0.472805
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.481744
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.489829
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.487313
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.488797
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.482086
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.480627
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.476416
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.485666
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.494017
         Iterations 26
Optimization terminated successfully.
         Current function value: 0.491208
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.493195
         Iterations 17
Optimization terminated successfully.
         Current function value: 0.487183
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.480645
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.476480
         Iterations 17
Optimization terminated successfully.
         Current function value: 0.485956
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.494354
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.491211
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493243
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487154
         Iterations 16
Optimization terminated successfully.
         Current function value: 0.477278
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.473792
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.482306
         Iterations 17
Optimization terminated successfully.
         Current function value: 0.490219
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.488044
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.489943
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.482858
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.479297
         Iterations 20
Optimization terminated successfully.
         Current function value: 0.474684
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.484776
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.493617
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.490568
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.492249
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.486671
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.475843
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.471634
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.480500
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.489746
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.486206
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.488990
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.481511
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.475746
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.472357
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.480959
         Iterations 19
Optimization terminated successfully.
         Current function value: 0.489955
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.486858
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.489035
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.481098
         Iterations 11</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.479829
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.475904
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.484925
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.493494
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.490633
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.492702
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486749
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.480163
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.475509
         Iterations 17
Optimization terminated successfully.
         Current function value: 0.485966
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.494273
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.491212
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.493022
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.486992
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.476920
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.474440
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.482063
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.490702
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.488018
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.490310
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.482236
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.479245
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.475623
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.485557
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.494134
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.491278
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.493061
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487236
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.479574
         Iterations 18
Optimization terminated successfully.
         Current function value: 0.475950
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.485325
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.493835
         Iterations 21
Optimization terminated successfully.
         Current function value: 0.490669
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.492479
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.486400
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.476547
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.473751
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.481810
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.490331
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487866
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.489729
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.482669
         Iterations 23
Optimization terminated successfully.
         Current function value: 0.480127
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.477096
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.485897
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.494286
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.491411
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.493305
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.487226
         Iterations 6
Degree of interactions being considered: 3 , 5-fold CV RMSE: 0.3930114770697453
Optimization terminated successfully.
         Current function value: 0.475759
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.471622
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.480492
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.489601
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486179
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.488970
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.481508
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.475598
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.471173
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.480292
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.489152
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.485631
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.488677
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.481119
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.475116
         Iterations 28
Optimization terminated successfully.
         Current function value: 0.469516
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.479720
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.489033
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.484953
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487905
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.480868
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.474643
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.471264
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.479382
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.488663
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.485926
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.488072
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.480620
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.475771
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.471613
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.480500
         Iterations 11</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.489699
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486204
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.488888
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.481508
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.475629
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.471633
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.480435
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.489339
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486088
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.488916
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.481106
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.475578
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.471001
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.480251
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.488830
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.485747
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.488475
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.481239
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.475671
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.471280
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.480336
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.489106
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.485743
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.488735
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.481237
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.475650
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.471390
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.480356
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.489195
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.485736
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.488722
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.481223
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.475599
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.470943
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.480317
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.488975
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.485540
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.488507
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.481146
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.475618
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.471293
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.480019
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.488733
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.485614
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.488650
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.480961
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.475835
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.471524
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.480469
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.489743
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.486176
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.488990
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.481463
         Iterations 17
Optimization terminated successfully.
         Current function value: 0.475715
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.471352
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.480394
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.489745
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.485637
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.488756
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.481386
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.475821
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.470752
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.480407
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.489609
         Iterations 16
Optimization terminated successfully.
         Current function value: 0.485700
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.488766
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.481254
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.474779
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.470533
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.480076
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.488428
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.485464
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.488115
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.481014
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.474717
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.469628
         Iterations 19
Optimization terminated successfully.
         Current function value: 0.479574
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.487855
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.484909
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.487064
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.480098
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.475718
         Iterations 8</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.470990
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.480342
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.489467
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.485903
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.488801
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.481344
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.475301
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.470549
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.480033
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.488234
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.485551
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.488159
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.480632
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.475843
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.471634
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.480500
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.489746
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.486206
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.488990
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.481511
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.474007
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.469411
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.479130
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.488143
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.484628
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.487433
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.479465
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.475220
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.471428
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.480251
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.488880
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.485801
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.488672
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.480486
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.474686
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.470486
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.479795
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.488313
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.485478
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487999
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.480824
         Iterations 9
Degree of interactions being considered: 3 , 5-fold CV RMSE: 0.39243075325594085
Optimization terminated successfully.
         Current function value: 0.474852
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.469090
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.479502
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.488435
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.484356
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487584
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.480473
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.475116
         Iterations 28
Optimization terminated successfully.
         Current function value: 0.469516
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.479720
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.489033
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.484953
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487905
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.480868
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.474801
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.468929
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.479441
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.488179
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.484229
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487460
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.480451
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.474788
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.469043
         Iterations 25
Optimization terminated successfully.
         Current function value: 0.479453
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.488268
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.484209
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487452
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.480432
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.474705
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.468833
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.479011
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.487698
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.483967
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487326
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.480146
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.474965
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.469509
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.479667
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.489012
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.484943
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487886
         Iterations 7</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.480864
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.474998
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.468807
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.479566
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.488758
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.484666
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487719
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.480703
         Iterations 7
Degree of interactions being considered: 3 , 5-fold CV RMSE: 0.39195129359084385
Optimization terminated successfully.
         Current function value: 0.474700
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.468833
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.479011
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.487660
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.483948
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.487215
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.480135
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.474699
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.468730
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.478994
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487627
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.483947
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487326
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.480145
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.474682
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.468833
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.478997
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487697
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.483932
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487318
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.480131
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.474705
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.468833
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.479011
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.487698
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.483967
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487326
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.480146
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.474592
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.468103
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.478843
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.487415
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.483683
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.487136
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.479972
         Iterations 8
Degree of interactions being considered: 3 , 5-fold CV RMSE: 0.3919011032018308
Optimization terminated successfully.
         Current function value: 0.474592
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.468103
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.478843
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.487415
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.483683
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.487136
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.479972
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.474029
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.467934
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.477925
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486441
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.483471
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486518
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.479166
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.474418
         Iterations 16
Optimization terminated successfully.
         Current function value: 0.468087
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.478801
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.487400
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.483597
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487110
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.479883
         Iterations 33
Optimization terminated successfully.
         Current function value: 0.474561
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.468103
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.478843
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487308
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.483612
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487134
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.479972
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.474524
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.468101
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.478843
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.487414
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.483682
         Iterations 16
Optimization terminated successfully.
         Current function value: 0.487134
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.479967
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.474589
         Iterations 16</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.468102
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.478840
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487384
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.483669
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487043
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.479939
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.474516
         Iterations 17
Optimization terminated successfully.
         Current function value: 0.467930
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.478751
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.487378
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.483575
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487099
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.479669
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.473988
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.467852
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.477376
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.486244
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.483368
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.486272
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.478995
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.473629
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.467928
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.477093
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.486141
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.483145
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.486263
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.478903
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.473852
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.468060
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.477920
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.486830
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.482964
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.486407
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.479323
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.473173
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.467645
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.477659
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.486190
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.483255
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.485980
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.478814
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.473421
         Iterations 16
Optimization terminated successfully.
         Current function value: 0.467740
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.477766
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.486162
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.482448
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.485492
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.478766
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.473501
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.467899
         Iterations 17
Optimization terminated successfully.
         Current function value: 0.477729
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.486406
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.483436
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486609
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.479190
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.473350
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.467655
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.477781
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.486152
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.482408
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.485380
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.478700
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.474386
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.468069
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.478830
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487233
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.483652
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.486992
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.479962
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.473163
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.467690
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.477873
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.486084
         Iterations 16
Optimization terminated successfully.
         Current function value: 0.482265
         Iterations 18
Optimization terminated successfully.
         Current function value: 0.485364
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.478659
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.474018
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.467939
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.477465
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.485873
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.483187
         Iterations 7</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.486215
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.478992
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.474225
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.468082
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.478718
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.487351
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.483509
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.486861
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.479832
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.474428
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.468058
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.478829
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.487172
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.483645
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.487107
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.479772
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.473995
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.467938
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.477669
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.486185
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.483414
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.486430
         Iterations 16
Optimization terminated successfully.
         Current function value: 0.479194
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.473533
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.468043
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.477956
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.486519
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.482546
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.485844
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.479199
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.474467
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.467950
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.478836
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.487025
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.483659
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.487104
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.479821
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.474433
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.468036
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.478842
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.487365
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.483677
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.487084
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.479968
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.474317
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.468077
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.478539
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.486769
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.483230
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.486800
         Iterations 19
Optimization terminated successfully.
         Current function value: 0.479734
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.474536
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.467811
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.478799
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.487119
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.483581
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.487128
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.479969
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.473923
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.467921
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.477751
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.486401
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.483441
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.486260
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.479112
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.474193
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.468086
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.478805
         Iterations 16
Optimization terminated successfully.
         Current function value: 0.487401
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.483579
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487106
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.479887
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.474388
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.467841
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.478678
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.486791
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.483332
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.486850
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.479886
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.474411
         Iterations 10</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.468046
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.478811
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.487403
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.483645
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.486715
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.479886
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.474038
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.467868
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.477804
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.486408
         Iterations 15
Optimization terminated successfully.
         Current function value: 0.483442
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.486613
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.479295
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.474359
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.468091
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.478809
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.487408
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.483591
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.487127
         Iterations 12
Optimization terminated successfully.
         Current function value: 0.479913
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.474557
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.467899
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.478818
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.487250
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.483489
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487025
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.479964
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.474366
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.467777
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.478723
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487311
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.483623
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.486718
         Iterations 13
Optimization terminated successfully.
         Current function value: 0.479734
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.474535
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.467766
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.478782
         Iterations 11
Optimization terminated successfully.
         Current function value: 0.487224
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.483634
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487022
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.479958
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.474571
         Iterations 10
Optimization terminated successfully.
         Current function value: 0.467980
         Iterations 16
Optimization terminated successfully.
         Current function value: 0.478835
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.487374
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.483643
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.487018
         Iterations 14
Optimization terminated successfully.
         Current function value: 0.479955
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.474567
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.467936
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.478827
         Iterations 7
Optimization terminated successfully.
         Current function value: 0.487318
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.483500
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.486925
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.479951
         Iterations 6
Optimization terminated successfully.
         Current function value: 0.474395
         Iterations 9
Optimization terminated successfully.
         Current function value: 0.468094
         Iterations 8
Optimization terminated successfully.
         Current function value: 0.478754
         Iterations 7</code></pre>
</div>
</div>
<div class="cell" data-execution_count="257">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>selected_interactions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="257">
<pre><code>'+I(int_rate**2)+I(out_prncp_inv**2)+loan_amnt*mort_acc+mort_acc*total_rec_late_fee+loan_amnt*total_rec_late_fee+out_prncp_inv*int_rate*bc_util+I(out_prncp_inv**3)+I(loan_amnt**2)*mort_acc+loan_amnt*mort_acc*total_rec_late_fee'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="258">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="op">=</span> sm.logit(<span class="st">'hi_int_prncp_pd~out_prncp_inv+loan_amnt+mort_acc+int_rate+out_prncp_inv*int_rate+</span><span class="ch">\</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="st">I(out_prncp_inv ** 3)+I(out_prncp_inv ** 2)+annual_inc*out_prncp_inv+Joint_app+</span><span class="ch">\</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="st">Individual_app+term_36_months+term_60_months+total_rec_late_fee+bc_util'</span><span class="op">+</span>selected_interactions,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> train_1).fit()</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>model1.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Optimization terminated successfully.
         Current function value: 0.480531
         Iterations 7</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="258">

<table class="simpletable">
<caption>Logit Regression Results</caption>
<tbody><tr>
  <th>Dep. Variable:</th>    <td>hi_int_prncp_pd</td> <th>  No. Observations:  </th>   <td>  2444</td>  
</tr>
<tr>
  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>   <td>  2420</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>   <td>    23</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Thu, 16 Mar 2023</td> <th>  Pseudo R-squ.:     </th>   <td>0.2994</td>  
</tr>
<tr>
  <th>Time:</th>                <td>00:51:46</td>     <th>  Log-Likelihood:    </th>  <td> -1174.4</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th>  <td> -1676.3</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>2.065e-197</td>
</tr>
</tbody></table>
<table class="simpletable">
<tbody><tr>
                    <td></td>                       <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P&gt;|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>                             <td>   -2.3014</td> <td>      nan</td> <td>      nan</td> <td>   nan</td> <td>      nan</td> <td>      nan</td>
</tr>
<tr>
  <th>out_prncp_inv</th>                         <td>    0.0003</td> <td> 6.53e-05</td> <td>    4.269</td> <td> 0.000</td> <td>    0.000</td> <td>    0.000</td>
</tr>
<tr>
  <th>loan_amnt</th>                             <td>   -0.0001</td> <td> 3.53e-05</td> <td>   -3.373</td> <td> 0.001</td> <td>   -0.000</td> <td>-4.98e-05</td>
</tr>
<tr>
  <th>mort_acc</th>                              <td>   -0.2022</td> <td>    0.115</td> <td>   -1.766</td> <td> 0.077</td> <td>   -0.427</td> <td>    0.022</td>
</tr>
<tr>
  <th>int_rate</th>                              <td>    0.5546</td> <td>    0.063</td> <td>    8.760</td> <td> 0.000</td> <td>    0.431</td> <td>    0.679</td>
</tr>
<tr>
  <th>out_prncp_inv:int_rate</th>                <td>-7.862e-07</td> <td> 3.12e-06</td> <td>   -0.252</td> <td> 0.801</td> <td>-6.91e-06</td> <td> 5.34e-06</td>
</tr>
<tr>
  <th>I(out_prncp_inv ** 3)</th>                 <td> 1.475e-13</td> <td> 6.02e-14</td> <td>    2.451</td> <td> 0.014</td> <td> 2.95e-14</td> <td> 2.65e-13</td>
</tr>
<tr>
  <th>I(out_prncp_inv ** 2)</th>                 <td>-1.096e-08</td> <td> 3.29e-09</td> <td>   -3.331</td> <td> 0.001</td> <td>-1.74e-08</td> <td>-4.51e-09</td>
</tr>
<tr>
  <th>annual_inc</th>                            <td> 1.172e-07</td> <td> 3.39e-07</td> <td>    0.345</td> <td> 0.730</td> <td>-5.48e-07</td> <td> 7.82e-07</td>
</tr>
<tr>
  <th>annual_inc:out_prncp_inv</th>              <td>-3.311e-11</td> <td> 4.29e-11</td> <td>   -0.772</td> <td> 0.440</td> <td>-1.17e-10</td> <td>  5.1e-11</td>
</tr>
<tr>
  <th>Joint_app</th>                             <td>   -0.9867</td> <td>      nan</td> <td>      nan</td> <td>   nan</td> <td>      nan</td> <td>      nan</td>
</tr>
<tr>
  <th>Individual_app</th>                        <td>   -1.3147</td> <td>      nan</td> <td>      nan</td> <td>   nan</td> <td>      nan</td> <td>      nan</td>
</tr>
<tr>
  <th>term_36_months</th>                        <td>   -1.9210</td> <td> 2.52e+06</td> <td>-7.63e-07</td> <td> 1.000</td> <td>-4.93e+06</td> <td> 4.93e+06</td>
</tr>
<tr>
  <th>term_60_months</th>                        <td>   -0.3803</td> <td> 2.52e+06</td> <td>-1.51e-07</td> <td> 1.000</td> <td>-4.93e+06</td> <td> 4.93e+06</td>
</tr>
<tr>
  <th>total_rec_late_fee</th>                    <td>    0.0090</td> <td>    0.020</td> <td>    0.456</td> <td> 0.649</td> <td>   -0.030</td> <td>    0.047</td>
</tr>
<tr>
  <th>bc_util</th>                               <td>   -0.0238</td> <td>    0.010</td> <td>   -2.345</td> <td> 0.019</td> <td>   -0.044</td> <td>   -0.004</td>
</tr>
<tr>
  <th>I(int_rate ** 2)</th>                      <td>   -0.0129</td> <td>    0.002</td> <td>   -7.405</td> <td> 0.000</td> <td>   -0.016</td> <td>   -0.010</td>
</tr>
<tr>
  <th>loan_amnt:mort_acc</th>                    <td>  1.96e-05</td> <td> 1.24e-05</td> <td>    1.579</td> <td> 0.114</td> <td>-4.73e-06</td> <td> 4.39e-05</td>
</tr>
<tr>
  <th>mort_acc:total_rec_late_fee</th>           <td>    0.0093</td> <td>    0.012</td> <td>    0.794</td> <td> 0.427</td> <td>   -0.014</td> <td>    0.032</td>
</tr>
<tr>
  <th>loan_amnt:total_rec_late_fee</th>          <td>-3.088e-08</td> <td> 1.05e-06</td> <td>   -0.030</td> <td> 0.976</td> <td>-2.08e-06</td> <td> 2.02e-06</td>
</tr>
<tr>
  <th>out_prncp_inv:bc_util</th>                 <td> 1.472e-06</td> <td> 6.41e-07</td> <td>    2.297</td> <td> 0.022</td> <td> 2.16e-07</td> <td> 2.73e-06</td>
</tr>
<tr>
  <th>int_rate:bc_util</th>                      <td>    0.0014</td> <td>    0.001</td> <td>    1.903</td> <td> 0.057</td> <td> -4.3e-05</td> <td>    0.003</td>
</tr>
<tr>
  <th>out_prncp_inv:int_rate:bc_util</th>        <td>-8.152e-08</td> <td> 4.76e-08</td> <td>   -1.712</td> <td> 0.087</td> <td>-1.75e-07</td> <td> 1.18e-08</td>
</tr>
<tr>
  <th>I(loan_amnt ** 2)</th>                     <td> 1.682e-09</td> <td> 8.82e-10</td> <td>    1.908</td> <td> 0.056</td> <td> -4.6e-11</td> <td> 3.41e-09</td>
</tr>
<tr>
  <th>I(loan_amnt ** 2):mort_acc</th>            <td>-3.331e-10</td> <td> 2.89e-10</td> <td>   -1.153</td> <td> 0.249</td> <td>-8.99e-10</td> <td> 2.33e-10</td>
</tr>
<tr>
  <th>loan_amnt:mort_acc:total_rec_late_fee</th> <td>-5.329e-07</td> <td> 5.22e-07</td> <td>   -1.022</td> <td> 0.307</td> <td>-1.56e-06</td> <td> 4.89e-07</td>
</tr>
</tbody></table>
</div>
</div>
<div class="cell" data-execution_count="259">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> pd.DataFrame({<span class="st">'id'</span>:test.iloc[:,<span class="dv">0</span>], <span class="st">'Category'</span>:model1.predict(test)})</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> pd.concat([predictions,test.out_prncp_inv], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>predictions[<span class="st">'Category'</span>] <span class="op">=</span> (predictions[<span class="st">'Category'</span>]<span class="op">&gt;</span><span class="fl">0.4</span>).astype(<span class="bu">int</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>predictions.loc[predictions.out_prncp_inv <span class="op">==</span> <span class="dv">0</span>, <span class="st">'Category'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> predictions.drop(<span class="st">'out_prncp_inv'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>predictions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="259">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>id</th>
      <th>Category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3813</th>
      <td>3814</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3814</th>
      <td>3815</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3815</th>
      <td>3816</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3816</th>
      <td>3817</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3817</th>
      <td>3818</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>3818 rows × 2 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="261">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>predictions.to_csv(<span class="st">'ClassificationPrediction.csv'</span>, index <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>